<div *ngIf="isVisibleForm" class="item">
  <form #form [formGroup]="formGroup" nz-form nzLayout="horizontal">
    <nz-form-item>
      <nz-form-control nzErrorTip="Không được để trống!">
        <textarea [autofocus]="true" [nzAutosize]="{ minRows: 3 }" formControlName="ten" nz-input
          placeholder="Nhập tên công việc mới" style="width: 100%">
        </textarea>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control>
        <nz-select [nzMaxTagCount]="1" [nzMaxTagPlaceholder]="tagPlaceHolderListUser" formControlName="listIdThanhVien"
          nzMode="multiple" nzPlaceHolder="Chọn thành viên">
          <nz-option *ngFor="let item of listUserCaNhan" [nzLabel]="item.hoTen" [nzValue]="item.id" nzCustomContent>
            <div nz-tooltip="Số công việc đang thực hiện" class="bagde-custom">{{ item.soCongViecDangThucHien }}</div>
            {{ item.hoTen }}
          </nz-option>
        </nz-select>
        <ng-template #tagPlaceHolderListUser let-selectedList>+ {{ selectedList.length }} </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control>
        <upload-tai-lieu-cong-viec formControlName="jsonTaiLieu"></upload-tai-lieu-cong-viec>
      </nz-form-control>
    </nz-form-item>

    <div class="group-btn">
      <button (click)="add()" nz-button nzType="primary">Thêm</button>
      <button (click)="cancel()" nz-button>Đóng</button>
    </div>
  </form>
</div>
<ng-container *ngIf="listCongViec?.length">
  <div (cdkDragStarted)="dragStart($event)" *ngFor="let data of listCongViec" [cdkDragData]="data" cdkDrag class="item">
    <div (click)="suaCongViec(data)">
      <div class="head">
        <div nz-tooltip="Số đã hoàn thành/Tổng số mục trong danh sách công việc" nzTooltipPlacement="topLeft">
          <span nz-icon nzTheme="outline" nzType="profile"></span> {{ data.soViecDaHoanThanh }} / {{ data.soViec }}
        </div>
        <div nz-tooltip="Thời gian hoàn thành" nzTooltipPlacement="topRight">
          {{ data.ngayHoanThanh | date : 'dd/MM/yyyy ' }}
        </div>
      </div>
      <h6>
        {{ data.ten }}
      </h6>
      <!--      <div [ngSwitch]="data.mucDo">-->
      <!--        <nz-tag *ngSwitchCase="MUC_DO_CONG_VIEC.QUAN_TRONG" nz-tooltip="Mức độ ưu tiên" nzColor="volcano">Quan trọng-->
      <!--        </nz-tag>-->
      <!--        <nz-tag *ngSwitchCase="MUC_DO_CONG_VIEC.BINH_THUONG" nz-tooltip="Mức độ ưu tiên" nzColor="cyan">Bìnhthường-->
      <!--        </nz-tag>-->
      <!--      </div>-->
      <div class="bot">
        <div>
          <span *ngIf="data.mucDo === MUC_DO_CONG_VIEC.QUAN_TRONG" nz-tooltip="Công việc quan trọng">
            <i class="badge-warning-color" nz-icon nzTheme="fill" nzType="star"></i>
          </span>
          <span nz-tooltip="Số tài liệu đính kèm"> <i nz-icon nzTheme="outline" nzType="paper-clip"></i> {{
            data.soTaiLieu }} </span>
          <span nz-tooltip="Số trao đổi"> <i nz-icon nzTheme="outline" nzType="message"></i> {{ data.soTraoDoi }}
          </span>
          <span nz-tooltip="Số thành viên">
            <i nz-icon nzTheme="outline" nzType="usergroup-add"></i> {{ data.listUser?.length || 0 }}
          </span>
        </div>
        <div>
          <i (click)="delete($event, data)"
            *ngIf="permission.lanhDao && data.isMyCreate && trangThai === TRANG_THAI_CONG_VIEC.TAO_MOI"
            class="delete-icon" nz-icon nz-tooltip="Xóa" nzTheme="outline" nzType="delete">
          </i>
        </div>
      </div>
    </div>
  </div>
</ng-container>